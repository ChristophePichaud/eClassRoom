@page "/clients"
@inherits ClientsBase

<h3>Gestion des clients</h3>

<button class="btn btn-primary mb-2" @onclick="ShowAddClient">Nouveau client</button>

@if (isLoading)
{
    <p>Chargement...</p>
}
else
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Nom société</th>
                <th>Adresse</th>
                <th>Code postal</th>
                <th>Ville</th>
                <th>Pays</th>
                <th>Email administrateur</th>
                <th>Mobile</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var client in clients)
            {
                <tr>
                    <td>@client.NomSociete</td>
                    <td>@client.Adresse</td>
                    <td>@client.CodePostal</td>
                    <td>@client.Ville</td>
                    <td>@client.Pays</td>
                    <td>@client.EmailAdministrateur</td>
                    <td>@client.Mobile</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-1" @onclick="() => EditClient(client)">Modifier</button>
                        <button class="btn btn-sm btn-danger" @onclick="() => DeleteClient(client.Id)">Supprimer</button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

@if (showForm)
{
    <EditForm Model="editClient" OnValidSubmit="SaveClient">
        <DataAnnotationsValidator />
        <ValidationSummary />
        <h5>@(isEdit ? "Modifier le client" : "Créer un nouveau client")</h5>
        <div class="mb-2">
            <label>Nom société</label>
            <InputText class="form-control" @bind-Value="editClient.NomSociete" />
        </div>
        <div class="mb-2">
            <label>Adresse</label>
            <InputText class="form-control" @bind-Value="editClient.Adresse" />
        </div>
        <div class="mb-2">
            <label>Code postal</label>
            <InputText class="form-control" @bind-Value="editClient.CodePostal" />
        </div>
        <div class="mb-2">
            <label>Ville</label>
            <InputText class="form-control" @bind-Value="editClient.Ville" />
        </div>
        <div class="mb-2">
            <label>Pays</label>
            <InputText class="form-control" @bind-Value="editClient.Pays" />
        </div>
        <div class="mb-2">
            <label>Email administrateur</label>
            <InputText class="form-control" @bind-Value="editClient.EmailAdministrateur" />
        </div>
        <div class="mb-2">
            <label>Mobile</label>
            <InputText class="form-control" @bind-Value="editClient.Mobile" />
        </div>
        <div class="mb-2">
            <label>Mot de passe administrateur</label>
            <InputText class="form-control" @bind-Value="editClient.MotDePasseAdministrateur" type="password" />
        </div>
        <button class="btn btn-success me-2" type="submit">Enregistrer</button>
        <button class="btn btn-secondary" type="button" @onclick="CancelEdit">Annuler</button>
    </EditForm>
}